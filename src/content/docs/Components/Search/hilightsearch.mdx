---
title: Highlight Active Search
description: Active Search with HTMX with Highlited Matches
tableOfContents: 
  minHeadingLevel: 2
  maxHeadingLevel: 5
---
		 
{/* Introduction */}
## Example

This hypcomponent is a prototype for [hypermedia exchange](https://htmx.org/essays/hypermedia-apis-vs-data-apis/) because it illustrates a front-end coupled to backend routes that respond to XHR requests by returning only html markup.

An active search `<input>` is shown  which is based on the [Active Search example from the htmx documentation](http://htmx.org/examples/active-search/).   However, this hyperComponent expands on that example by providing live hilighting of matched substrings.  In addition, the hilight color can be selected from a dropdown menu containing the full Tailwind color pallet.  Clicking a color from the pallet changes the highlight color.    Another dropdown menu provides options for changing the match criteria. 

All functionality is powered by [htmx](https://htmx.org) and [Hypersript](https://hyperscript.org).  There are no JavaScript imports or `<script>` tags at all in this component. 

 A mini-project is included below to illustrate how this hyperComponent works.   The  example project displays a table of famous speeches in the English language.  Clicking any table row loads the full speech transcript and then switches focus to the Search `<input>`.   Any substring entered into the  Search `<input>` is then matched against the full transcript using regular expressions.  
 
 Successful matches are  surrounded with `<mark`> tags styled with the user's choice of Tailwind bg-color-*. The server returns the full speech transcript as html annotated with `<mark>` elements.  The user's  experience is analagous to using a felt tipped highlight marker on a printed document.

Take a tour of the example project by clicking on a famous speech.  Click  the Reset button (or select another speech) to start over.

The subsequent discussions go into great etail about all the source code used to create this  hyperComponent.

import {tw as rowStyles} from '../../../../pages/api/speeches'
		 
export const tw = {
		exampleContainer: 'not-content',
		exampleTitle: 'text-center bg-gray-300 dark:bg-sky-900 text-gray-300 dark:text-zinc-200 font-semibold py-2 mb-4 rounded-t-xl',
		icon:'inline-block size-6',
		image: 'inline-block max-h-6',
		p: 'pb-3'	,
		introduction: {
		h3: 'text-center text-xl lg:text-2xl',
		h4: 'pt-8 pb-4 text-center text-lg lg:text-xl',
		p: 'text-center font-semibold'	
		},
		table:'mx-auto my-4 max-w-max',
		...rowStyles,
		searchExample:{
			container: 'not-content pt-12 flex flex-nowrap justify-between items-center gap-2',
			colorPallet: 'colorPallet size-12 rounded-2xl ' +
				'bg-sky-700  dark:bg-indigo-600 ',
			palletIcon: 'inline-block size-6' ,
			resetButton: 'px-4 py-3 cursor-pointer rounded-xl ' + 
				'text-lg text-zinc-50 dark:text-zinc-300 ' +
				'bg-sky-700  dark:bg-indigo-600',
		},
		speech:{
			wrapper: 'not-content w-full mx-auto max-h-[50rem] overflow-y-auto rounded-t-lg ' + 
				'bg-gray-100 dark:bg-gray-950',
			title: 'p-4 text-center text-balance text-xl ' + 
				'text-indigo-900 dark:text-amber-100/80 ' + 
				'border-b-2 border-gray-200 dark:border-gray-700 ',
			transcript: 'p-4'
		},
}

{/* Intro */}
<div id='highlight-search-example' class={tw.exampleContainer} >
<div id='highlight-search-title' class={tw.exampleTitle}>Sample Highlight Active Search Control</div>
<div id="introduction" class="w-10/12 mx-auto">
	<h3 class={tw.introduction.h3}>Famous Speeches in the English Language</h3>
	<h4 class={tw.introduction.h4}>Use the Search control below to highlight words from the most famous speeches that shaped  our world.</h4>
	<p class={tw.introduction.p}>Click to select any Speech from the list</p>
</div>
</div>

{/*  Table of Famous Speeches */}
<table class={tw.table}
				id="all-speeches"
				hx-trigger="load"  
				hx-get="/api/speeches/"
				hx-target="<tbody/>"
				hx-swap="innerHTML"
				script={hs.table}>
	<thead>
		<tr><th>Speaker</th><th>Title</th><th>Date</th></tr>
	</thead>
	<tbody></tbody>
</table>


		 


import Searchbox from '../../../../components/search/searchbox.astro'
import ClickDropdownMenu_A from '../../../../components/ClickDropdownMenu_A.astro'
import PalletGrid from '../../../../components/PalletGrid.astro'

export const defaultSpeechTitle = 'Click on the any of the famous orations listed above.'
export const defaultSpeechTranscript = 'The full transcript will be displayed here. Use the Search box to dynamnically highlight any part of the transcript'

export const hs = {
	resetButton:`
		on load
			put the "${defaultSpeechTitle}" into the #{'speech-title'} then
			put the "${defaultSpeechTranscript}" into the #{'speech-transcript'} then 
			send reset to the <table#all-speeches/> 
			send reset to the #{'searchbox'}
		end 
		
		on click 
			go to the #{'introduction'} smoothly
		end`,
	table: `								
		on reset
			remove .${tw.rowHilight} from <tr/>
		end `,
	colorPallet: `
		on click 
			-- cache the hilight color in a data-* attribute
			-- transmit the highlight color to the backend via a hidden <input/>
			set originalHilightColor to the @data-hilight-color of the #{'search-container'}
			remove .{originalHilightColor} from the #{'search-container'}
			set newHilightColor to my @bgColor
			add .{newHilightColor} to the #{'search-container'}
			set the @data-hilight-color of the #{'search-container'} to the newHilightColor
			set the value of the #{'hilight-color'} to the newHilightColor
			trigger update on the  #{'searchbox'}
		end
		`
}



{/*  Search Box Example*/}
<div class={tw.searchExample.container}>
	<Searchbox id="searchbox" 
		searchPath="/api/speeches/match/" 
		target="#speech-transcript" 
		swapStrategy="innerHTML"
		height="h-12"
	/>

	<ClickDropdownMenu_A id='colorpallet' 
		moveXY='-200,18'
		buttonStyles={tw.searchExample.colorPallet} 
		duration='180ms'>
	<img slot="leftIcon" src='/images/tailwind_icon.svg' 
		alt='tailwind icon' class={tw.searchExample.palletIcon}/>
	<PalletGrid orientation='vertical' hs={hs.colorPallet}/>
</ClickDropdownMenu_A>	 

	<button class={tw.searchExample.resetButton} 
		script={hs.resetButton}>Reset</button>
</div>


<div class={tw.speech.wrapper}>
	<h4 id="speech-title" class={tw.speech.title}></h4>
	<div id="speech-transcript" class={tw.speech.transcript}>
	</div>
</div>


		 
## Description
	{/* General Description */}
	{/* Example  Code block showing the  control in action. */}

[Hypermedia exchanges](https://htmx.org/essays/hypermedia-apis-vs-data-apis/) require that the backend return formatted, finished html.  Thus the developer must have control over the server's response.   The [Astro](https://astro.build) build tool is perfect for this because it is easy to create [custom API endpoints](https://docs.astro.build/en/guides/endpoints/).   In Astro, all that is needed is to place a .js file into the Pages folder.  In that file, you must export a GET, POST, PATCH or DELETE function and then Astro will build the correct route and respond to those AJAX requests.

The GET and POST requests in this example use data stored on disc (in JSON files), but does not return the raw data.  Instead, the data is used by the server  to format finished html fragments which are returned in the Response object.   HTMX attributes  specify how and where the returned markup is inserted into the DOM.  

Read through all the example code below to see how this was accomplished.


## Features

This Active Search with highlight hyperComponent will:

1.  Use Tailwind bg-color-* classes picked from a dropdown color pallet
2.  Match substrings entered into the `<input>` against a block of raw text
3.  Return html markup with `<mark>` tags surrounding any matched substring
4.  Allow optional restricted matching (case sensitive, whole word, or others)
5.  User selectable hilight color
6.  Smooth scrolling to the transcript and back to the search input
7.  Results are updated with keystrokes, pasteing text into the `<input`>, clearing the field, etc.
8.  Search `<input>` and dropdown menus are fully customizable using Tailwind utility classes
		 
## Components
	{/* Breakdown of each Astro Components used for this control */}

## API routes

All routing in Astro is file-based, including backend API routes.    Here is the folder/file structure used for this example, and 

### Searchbox.astro

## Code
	{/* Brief explanation of the component */}
import {Tabs, TabItem } from '@astrojs/starlight/components'
		 
<Tabs>
	<TabItem label='Props'>
	```js
		 
	```
	</TabItem>
		 
	<TabItem label='HTML'>
	```html
		 
	```
	</TabItem>
		 
	<TabItem label='Scripts'>
	```js
	```
	</TabItem>
		 
	<TabItem label='Tailwind'>
	```js
	```
	</TabItem>
		 
	<TabItem label='Everything'>
	```astro
		 
	```
	</TabItem>
</Tabs>
		 
##  Usage
	{/* Discuss use cases */}